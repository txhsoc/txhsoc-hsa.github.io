<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title align=center>HSA Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.css" />
<link rel="stylesheet"href="style/Control.OSMGeocoder.css"/>
<link rel="stylesheet"href="style/style.css"/>
<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>

<style>
  body { margin:0; padding:0; }
  html, body, #map { height: 100%; }
</style>
</head>

<body>
<div id="map"></div>
<script src="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.js"></script>
<script src="scripts/Leaflet.MakiMarkers.js"></script>
<script src="scripts/Control.OSMGeocoder.js"></script>
<link href='http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css' rel='stylesheet'>

<script>
//variable for bounding extent coordinates
var southWest = L.latLng(20.348, -113.974),
    northEast = L.latLng(42.423, -85.134),
    bounds = L.latLngBounds(southWest, northEast);

//variable for the map
var map = L.map( 'map', {
	maxBounds: bounds,
	maxZoom: 25,
	minZoom: 6
});

//keep the full extent of the map set to the bounding coordinates
map.fitBounds(bounds);

//add mapquest osm tiles for the basemap
L.tileLayer( 'http://{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png', {
	attribution: '&copy; <a href="http://osm.org/copyright" title="OpenStreetMap" target="_blank">OpenStreetMap</a> contributors | Tiles Courtesy of <a href="http://www.mapquest.com/" title="MapQuest" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png" width="16" height="16">',
    subdomains: ['otile1','otile2','otile3','otile4']
}).addTo( map );

//variable for the osm geocoder
var osmGeocoder = new L.Control.OSMGeocoder();
//add osm geocoder to map
map.addControl(osmGeocoder);

//style variable to assign to the districts.geojson file
var myStyle1 = {
    "color": "#ff0000",
    "weight": 2,
};

//style variable to assign to states, cuba, mexico geojson files
var myStyle2 = {
    "color": "#000000",
    "weight": 2,
    "fillColor": "#a4a4a4",
    "fillOpacity": .5,
};

//style variables to assign to crash events based on thp or pd attribute
var thp = {
	radius: 5,
	fillColor: "#ffff00",
	color: "#000",
	weight: 1,
	opacity: 0.25,
	fillOpacity: 0.8
};
var pd = {
	radius: 5,
	fillColor: "#ff0000",
	color: "#000",
	weight: 1,
	opacity: 0.25,
	fillOpacity: 0.8
};

//var thpIcon = L.MakiMarkers.icon({icon: "car", color: "ffff00", size: "m"});

//var pdIcon = L.MakiMarkers.icon({icon: "car", color: "ff0000", size: "m"});

//jquery ajax calls to grab external geojson files and add them to the map
$.getJSON("data/thp_districts.geojson",function(data){
  L.geoJson(data, {style: myStyle1}).addTo(map);
});

$.getJSON("data/us_states.geojson",function(data){
  L.geoJson(data, {style: myStyle2}).addTo(map);
});

$.getJSON("data/mexico.geojson",function(data){
  L.geoJson(data, {style: myStyle2}).addTo(map);
});

$.getJSON("data/cuba.geojson",function(data){
  L.geoJson(data, {style: myStyle2}).addTo(map);
});

$.getJSON("data/HSA_30Oct15.geojson",function(data){
  L.geoJson(data, {
    //style: function(feature){
	//switch (feature.properties.THP){
		//case '1': return thp;
		//case '0': return pd;
	  //}
	//}
    pointToLayer: function(feature,latlng) {
      var marker = L.circleMarker(latlng);
      marker.bindPopup('<b>THP District:  </b>' + feature.properties.Region + '<br/>' + '<b>Date:  </b>' + feature.properties.Date + '<br/>' + '<b>No. Killed:  </b>' + feature.properties.Killed + '<br/>' + '<b>City:  </b>' + feature.properties.City + '<br/>' + '<b>County:  </b>' + feature.properties.County);
      return marker;
    }
  }).addTo(map);
});
</script>
</body>
</html>